SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
-- ==================================================================================================================================================================================-- Versión:				<1.0>-- Creado por:			<Ronny Ramírez R.>-- Fecha de creación:	<30/03/2020>-- Descripción:			<Permite actualizar un registro en la tabla: SolicitudTransferencia, siempre que se encuentre en estado Guargado.>-- ==================================================================================================================================================================================-- Modificación:		<Ronny Ramírez R.> <30/03/2020> <Se cambia la implementación de del PA_ModificarSolicitudTransferencia, para hacerlo coincidir con la nueva acción de --															modificar un registro en estado de Guardar.> -- ==================================================================================================================================================================================-- Modificación:		<Ronny Ramírez R.> <30/03/2020> <Se cambia implementación del SP para hacerlo coincidir con nueva acción de modificar un registro de solicitud de --															transferencia en estado "Guardar".>-- ==================================================================================================================================================================================CREATE PROCEDURE	[Objeto].[PA_ModificarSolicitudTransferencia]	@Codigo								UNIQUEIDENTIFIER,	@UsuarioRedRealizaSolicitud			VARCHAR(30),	@CodOficina_Destino					VARCHAR(4),	@Observaciones						VARCHAR(250),	@Estado								CHAR(1)ASBEGIN	--Variables	DECLARE	@L_TU_CodSolicitudTransferencia			UNIQUEIDENTIFIER		= @Codigo,			@L_TC_UsuarioRedRealizaSolicitud		VARCHAR(30)				= @UsuarioRedRealizaSolicitud,			@L_TC_CodOficina_Destino				VARCHAR(4)				= @CodOficina_Destino,			@L_TF_Fecha								DATETIME2(7)			= GETDATE(),			@L_TC_Observaciones						VARCHAR(250)			= @Observaciones,			@L_TC_Estado							CHAR(1)					= @Estado,			@L_TF_Actualizacion						DATETIME2(7)			= GETDATE()	--Lógica	UPDATE	Objeto.SolicitudTransferencia			WITH (ROWLOCK)	SET		TC_UsuarioRedRealizaSolicitud			= @L_TC_UsuarioRedRealizaSolicitud,			TC_CodOficina_Destino					= @L_TC_CodOficina_Destino,			TF_Fecha								= @L_TF_Fecha,			TC_Observaciones						= @L_TC_Observaciones,			TC_Estado								= @L_TC_Estado,			TF_Actualizacion						= @L_TF_Actualizacion	WHERE	TU_CodSolicitudTransferencia			= @L_TU_CodSolicitudTransferencia	AND		TC_Estado								= 'G'END
GO
